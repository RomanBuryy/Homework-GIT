From master branch. Resolve confict!!!

